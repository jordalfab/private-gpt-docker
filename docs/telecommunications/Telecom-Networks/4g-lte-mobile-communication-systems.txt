Evolution from 1G to 5G
Let’s briefly discuss the evolution of mobile communication systems from 1G to 5G.
You might wonder, what does “G” stand for? “G” stands for “generation.”
1G (First Generation): The most famous 1G systems were AMPS and NMT. These were analog systems that only provided voice services, with no data capabilities.
2G (Second Generation): GSM is the most famous and widely deployed 2G system, still in use in many parts of the world. When GPRS technology was added, these systems became known as 2.5G, offering data rates of up to 50 kbps.
2.75G: As demand for data services increased, EDGE technology was added to GSM, resulting in 2.75G systems with data rates of up to 150 kbps.
3G (Third Generation): UMTS is the most widely deployed 3G technology, providing data rates of up to 384 kbps. With the addition of HSPA, 3.5G systems emerged, offering data rates of up to 10 Mbps. Further enhancements led to 3.75G systems with HSPA+, providing data rates of up to 20 Mbps.
4G (Fourth Generation): LTE is the standard 4G system, offering data rates between 20 to 50 Mbps depending on channel conditions. LTE Advanced aimed for data rates of 1 Gbps per user, though actual rates were in the low hundreds of Mbps.
5G (Fifth Generation): The targeted data rate for 5G is 20 Gbps, but actual user experiences are in the high hundreds of Mbps.
The fundamental driver in the evolution of mobile communication systems has been the increasing demand for higher data rates.

UpLink and Downlink communication
Whenever a mobile station wants to use the services of a mobile network, it connects to a base station. Base stations are typically the towers with antennas that you see on top of buildings. Another name for a base station is a Base Transceiver System (BTS). The term “transceiver” means that the base station can both transmit and receive signals from the mobile station simultaneously.
The communication from the mobile station to the base station is called uplink communication, while the communication from the base station to the mobile station is called downlink communication.

Cellular Architecture
One of the earliest mobile telephony systems was introduced by Bell Labs in New York City in the 1970s. This system used a powerful transmitter or base station with a coverage area of 1000 square miles, supporting 12 simultaneous calls. However, this capacity was very limited, serving only 12 mobile users at a time.
To increase the system’s capacity, despite the limited frequencies available for mobile communication, a new approach was needed. Additionally, coverage problems arose, such as poor signal reception in areas obstructed by mountains.
To address these issues, the cellular concept was introduced. Instead of using one powerful transmitter, many low-power transmitters with smaller coverage areas were deployed. For example, if 100 low-power transmitters each supported 12 simultaneous calls, the system could support 1200 calls in total, significantly increasing the number of mobile users.
This new architecture, known as cellular architecture, is named after its basic unit, the cell. A cell is the coverage area of a transmitter or base station. The total coverage area of a mobile operator is divided into these cells, which are often represented by the shape of a honeycomb.

Handover/Handoff
Suppose a mobile station is in a voice call with the network and is connected to Base Station 1. As it moves towards Base Station 2, the signal power it receives from Base Station 1 decreases until it reaches a certain threshold, known as the handoff or handover threshold. At this point, the mobile station connects to Base Station 2, meaning it is assigned a channel in Base Station 2 and switches its connection.
This process of switching from one base station to another is called handover or handoff.
If the mobile station is connected to Base Station 1 and moves towards Base Station 2, the power received from Base Station 1 decreases until it reaches the handoff threshold. Ideally, the mobile station should then connect to Base Station 2. However, if no channel is available in Base Station 2, the mobile station cannot complete the handover. The power received from Base Station 1 continues to decrease until it falls below the minimum acceptable signal level, resulting in a dropped call. This is known as an improper handover or handoff situation.
There are two thresholds to consider: the handoff threshold and the minimum acceptable signal level threshold. The difference between these two thresholds is called the delta.
If the delta is too large, the mobile station may frequently switch between base stations, causing a “ping-pong” effect with unnecessary handovers.
If the delta is too small, there may not be enough time for the mobile station to complete the handover to Base Station 2, especially if there is a delay in channel assignment. This can also result in a dropped call.
Therefore, the delta must be carefully chosen to balance these factors and ensure reliable handover performance.

Three Major Parts of 4G Network
A 4G network consists of three major parts:
User Equipment (UE):
This includes mobile devices with internet connectivity. Users utilize this equipment to connect to and access the services of a 4G network.
Access Network:
Known as the Access Network because it is where the user equipment connects to the 4G network, specifically to the base station. In 4G, this access network is called the Evolved Universal Terrestrial Radio Access Network (E-UTRAN).
Core Network:
In 4G, the core network is referred to as the Evolved Packet Core (EPC). The core network does not communicate directly with the user equipment but does so through the access network. It is responsible for the overall control of the user equipment, as well as the routing and establishment of calls. The core network connects to the access network via microwave links, electrical cables, or optical fibers.
The access network consists of base stations, also known as eNodeBs (evolved Node B), abbreviated as eNB. On the core network side, it includes nodes like the Home Subscriber Server (HSS) and the Policy and Charging Rules Function (PCRF), as well as routers known as gateways, such as the Serving Gateway (SGW) and the Packet Data Network Gateway (PGW).

Evolution to an all IP system in 4G
When 2G GSM networks were first introduced, they only supported circuit-switched voice, handled by the circuit-switched core, which was connected to the Public Switched Telephone Network (PSTN). The PSTN is the fixed telephony network, and the circuit-switched core managed incoming and outgoing calls from this network.
As we moved to 2.5G and 2.75G systems, as well as 3G mobile communication systems, the packet-switched core was introduced to provide data services. However, voice services were still handled by the circuit-switched core.
With the advent of 3G and 3G+ systems (such as HSPA, HSPA+, and HSDPA), a new entity called the IP Multimedia Subsystem (IMS) was introduced. IMS enabled voice over IP (VoIP) services by connecting to the packet-switched core and the IP network. This allowed for both packet-switched voice using IMS and circuit-switched voice using the circuit-switched core.
The transition to 4G marked a significant shift, as the circuit-switched core was completely eliminated. In 4G, only packet-switched voice is provided, meaning VoIP services are exclusively used. These services are facilitated by IMS, which connects to the packet-switched core, the IP network, and the PSTN to handle incoming and outgoing calls from the fixed telephony network.
In summary, 4G networks do not support circuit-switched voice; all voice services are provided over IP packets.

Evolved Node B (eNB)
Whenever user equipment (UE) connects to a 4G network, it connects through the eNodeB. The eNodeB is responsible for the radio transmission and reception between the network and the UE.
One of the key functions of the eNodeB is Radio Resource Management (RRM). This involves managing resources for multiple UEs trying to connect. For instance, if a UE wants to make a call, the eNodeB must determine if there are sufficient resources available. If so, the eNodeB allows the call, a process known as admission control.
Once the call is admitted, the eNodeB allocates physical resources, such as uplink and downlink channels. It also determines the transmission power for both the UE and itself to ensure efficient communication.
During a call, user data and signaling are exchanged between the UE and the eNodeB. This exchange needs protection through encryption and integrity protection:
Encryption ensures that data and signaling sent from the eNodeB to the UE are secure.
Integrity protection ensures that the data and signaling are not tampered with by any malicious entity intercepting the communication.
Another important function of the eNodeB is routing user data to the Serving Gateway (SGW). This is indicated by a solid line between the eNodeB and the SGW, representing the data path.
Additionally, the eNodeB compresses data before sending it to the UE in the downlink to conserve frequency bandwidth, a precious resource. Similarly, it decompresses data received from the UE.

EPS Bearer
In a 4G network, which is an all-IP system, all services provided to users—whether data, voice, or multimedia—are delivered over IP packets. The 4G network provides this IP connectivity to its users using EPS bearers.
You can think of an EPS bearer as a tunnel that extends from the user equipment (UE) through the eNodeB, the Serving Gateway (SGW), and up to the Packet Data Network Gateway (PGW). For example, if a UE is browsing a website on the internet, it requires an EPS bearer for that activity. Similarly, if the UE is in a voice call, it requires a different EPS bearer.
An EPS bearer is essentially an IP tunnel characterized by its Quality of Service (QoS) requirements. These requirements vary depending on the type of service being used. For instance, the QoS requirements for browsing the internet differ from those for making a voice call.
The important parameters that define QoS include:
Data Rate:
This can be guaranteed or non-guaranteed. For example, a voice call requires a guaranteed bit rate to ensure call quality.
Latency:
Latency refers to the delay in packet transmission. For voice calls, it is crucial that packets do not experience delays beyond a certain threshold to maintain call quality.
Priority:
Different services have different priorities. For example, a voice bearer has higher priority compared to a bearer used for browsing the internet.

4G EPC Architecture
Let’s discuss the 4G core network, starting with the Mobility Management Entity (MME).
Whenever user equipment (UE) communicates with the 4G core network via signaling, it directly interacts with the MME. For instance, when a UE is turned on, it registers with the 4G network through the MME. During this registration process, the MME authenticates the UE using security keys obtained from the Home Subscriber Server (HSS).
Once registered, the MME assigns a temporary identifier to the UE for secure communication, ensuring the permanent identifier is not exposed. The MME also maintains temporary data related to the UE, known as the UE context, which includes information from the HSS.
The MME assigns a default bearer to the UE, managing and establishing this bearer. It also selects the Serving Gateway (SGW) and Packet Data Network Gateway (PGW) through which the default bearer will pass.
Another crucial function of the MME is mobility management. A UE can be in either an idle or connected state. When idle, the MME tracks the UE’s location at the tracking area level. Tracking areas are non-overlapping regions within the 4G network. If a UE moves from one tracking area to another, it updates its location with the MME. This update is essential for handling incoming calls, as the MME contacts all cells within the tracking area to notify the UE.
When the UE is connected, its location is known at the cell level. If the UE moves to a different cell, it updates its location with the MME.
Finally, the MME handles inter-MME handovers. If a UE moves from the coverage area of one eNodeB to another connected to a different MME, the old MME selects the new MME to manage the handover process.

4G EPC Architecture: Serving Gateway (S-GW)
Let’s discuss the functions of the Serving Gateway (S-GW) in the 4G core network.
Once an EPS bearer is established between the user equipment (UE) and the 4G core network, user data can be exchanged over this bearer. The S-GW is the entity responsible for this data exchange. Essentially, the S-GW acts as a router, directing user data from the UE to the Packet Data Network Gateway (PGW) and vice versa, routing data from the PGW to the appropriate eNodeB for delivery to the UE.
Another important function of the S-GW is managing Quality of Service (QoS) requirements for different EPS bearers. These requirements are implemented using the Differentiated Services (DiffServ) protocol. The S-GW inserts QoS markers, known as DiffServ Code Points (DSCP), into the headers of IP packets associated with an EPS bearer.
The S-GW also plays a crucial role in anchor mobility. For example, if a UE moves from one eNodeB to another within the same S-GW’s coverage, the S-GW maintains the data path, acting as an anchor point. This ensures seamless handover between eNodeBs. Additionally, if the UE moves to a base station of a 2G or 3G system, the S-GW still acts as the anchor point, maintaining the data path during the handover.
When a UE is in idle mode and there is incoming data, the S-GW buffers this data and informs the Mobility Management Entity (MME) about the incoming data. The MME then pages the UE, prompting it to connect to the 4G network to receive the buffered data.
Lastly, the S-GW supports lawful interception. Law enforcement agencies can monitor user communications at the S-GW, as all data from eNodeBs connected to the S-GW passes through it, making it an effective point for traffic interception.

4G EPC Architecture: Packet Data Network Gateway (P-GW)
Let’s discuss the functions of the Packet Data Network Gateway (P-GW) in the 4G core network.
When user equipment (UE) registers with the Mobility Management Entity (MME), it is assigned an EPS bearer. As part of this process, the P-GW assigns an IP address to the UE, making this one of its most important functions.
The P-GW serves as the point of contact between the 4G core network and the packet data network, commonly known as the Internet. All internet traffic passes through the P-GW, which is equipped with a deep packet inspection device to filter incoming traffic for malware and unauthorized data.
Similar to the Serving Gateway (S-GW), the P-GW inserts Quality of Service (QoS) markers into the headers of IP packets associated with an EPS bearer. These markers, known as DiffServ Code Points (DSCP), vary according to the QoS requirements of different EPS bearers.
Another key function of the P-GW is to act as an anchor point during handovers. For example, if a UE moves from one eNodeB to another connected to a different S-GW, the P-GW maintains the data path, ensuring seamless handover between eNodeBs.
Additionally, the P-GW supports lawful interception, allowing law enforcement agencies to monitor user traffic. Since all data from eNodeBs connected to the P-GW passes through it, the P-GW is an effective point for traffic interception.

Policy and Charging Rules Function (PCRF)
Now, let’s discuss the Policy and Charging Rules Function (PCRF).
Suppose a user equipment (UE) has a default EPS bearer and is using it to browse the internet. If the UE wants to make a voice call, an additional EPS bearer is needed. The PCRF decides when and if this additional EPS bearer should be allocated to the UE.
The PCRF is responsible for formulating the Quality of Service (QoS) policies and charging rules for different data flows of various subscribers. It considers the required QoS for different flows, any restrictions (such as maximum bit rate), and whether the data rate of some users needs to be throttled. For example, if a UE is in poor channel conditions, its data rate may need to be throttled to meet QoS requirements. The PCRF includes these considerations in its QoS policies.
Similarly, the PCRF creates charging rules based on the billing criteria set by the operator. However, while the PCRF formulates these QoS policies and charging rules, it does not implement them directly. Instead, it passes these policies and rules to the Policy and Charging Enforcement Function (PCEF), which is part of the gateway, for implementation.

Policy and Charging Enforcement Function (PCEF) in P-GW
Now, let’s discuss the Policy and Charging Enforcement Function (PCEF).
The PCEF is part of the Packet Data Network Gateway (P-GW) and operates on the user plane. It uses deep packet inspection to enforce the Quality of Service (QoS) policies on the bearers, ensuring that each EPS bearer adheres to its respective QoS requirements.
Additionally, the PCEF is responsible for charging different data flows based on their volume and traffic type. The QoS policies and charging rules implemented by the PCEF can either be statically configured by the operator or dynamically obtained from the Policy and Charging Rules Function (PCRF).

Home Subscriber Server (HSS)
The Home Subscriber Server (HSS) in a 4G network is a central database for all users or subscribers. Its proper functioning is crucial for the overall performance of the 4G network.
When user equipment (UE) wants to register with the network to use its services, it must be authenticated to ensure it is genuine. This authentication process is managed by the Mobility Management Entity (MME), which requires security keys from the HSS.
Once authentication is complete and the UE is registered, the MME downloads relevant user data from the HSS. This data includes the user’s identification, the services they can access, the quality of service (QoS) for those services, and any roaming restrictions. For example, a user might not be allowed to roam in certain tracking areas.
The HSS also keeps track of the MME with which the UE is registered. This is important for handling incoming calls, especially if the UE is roaming and moves into the coverage area of an eNodeB connected to a different MME. The HSS ensures that incoming calls are directed to the correct MME.

Introduction Voice over LTE (VoLTE)
LTE is an all-IP system, meaning all services provided by LTE, including voice calls, are transmitted over IP packets. Unlike 2G and 3G networks, which supported circuit-switched voice calls, LTE does not support circuit-switched voice. Instead, voice over LTE (VoLTE) calls are based on the IP Multimedia Subsystem (IMS).
When GSM was first introduced in 1991, it only provided circuit-switched voice services, handled by the circuit-switched core, which interfaced with the fixed telephony network (PSTN) to manage incoming and outgoing calls.
As mobile technology evolved to 2.5G (GPRS) and 2.75G (EDGE), and the first versions of 3G, a packet-switched core was introduced to handle data services, while voice services remained circuit-switched. With the advent of 3G and 3G+ technologies (such as HSDPA, HSUPA, and HSPA+), the IMS was introduced in 2004 to provide packet-switched voice services, allowing voice to be carried over IP packets. This provided the option of either packet-switched voice using IMS or circuit-switched voice using the circuit-switched core.
In 4G LTE, the circuit-switched core was completely eliminated. The packet-switched core is used to provide both data services and packet-switched voice services via the IMS. The IMS also interfaces with the PSTN to handle incoming and outgoing calls from the fixed telephony network.
